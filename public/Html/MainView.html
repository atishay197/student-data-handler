<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
    <meta charset="UTF-8">
    <title>Send Requests</title>
</head>
<body>
New Student
<br>
<script>
    function submitform() {
        var fields = {};
        $("form.submit").find("input").each(function() {
            fields[this.name] = $(this).val();
        });
        console.log(fields);
        var redirectURL;
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http://localhost:9000/storeData", true);
        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
        xhr.onload = function () {
            if (xhr.readyState === xhr.DONE) {
                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    var objJSON = JSON.parse(xhr.responseText);
                    redirectURL = objJSON.finalURL;
                    window.open(redirectURL,"_self");
                }
            }
        };
        xhr.send(JSON.stringify(fields));
    }
</script>
<form class="submit">
    Name&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<input name="name"><br>
    College&nbsp;:&nbsp;<input name="college"><br>
    <button type="button" onclick="submitform()">Store Data</button>
</form>
<br>
<br>
Student Details
<br>
<script>
    function getData() {
        var fields = {};
        $("form.getData").find("input").each(function() {
            fields[this.name] = $(this).val();
        });
        console.log(fields);
        var redirectURL;
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http://localhost:9000/getData", true);
        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
        xhr.onload = function () {
            if (xhr.readyState === xhr.DONE) {
                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    var objJSON = JSON.parse(xhr.responseText);
                    redirectURL = objJSON.finalURL;
                    var details = JSON.parse(objJSON.response);
                    var urlNew = Object.keys(details).map(function(k) {
                        return encodeURIComponent(k) + '=' + encodeURIComponent(details[k])
                    }).join('&')
                    redirectURL = redirectURL + '?' + urlNew;
                    console.log(redirectURL);
                    window.open(redirectURL,"_self");
                }
            }
        };
        xhr.send(JSON.stringify(fields));
    }
</script>
<form class="getData">
    Name&nbsp;:&nbsp;<input name="name"><br>
    Roll&nbsp;:&nbsp;<input name="roll"><br>
    <button type="button" onclick="getData()">Get Data</button>
</form>
<br>
<br>
Teacher Grading
<br>

<script>
    function submitGrade() {
        var fields = {};
        $("form.teacher").find("input").each(function() {
            fields[this.name] = $(this).val();
        });
        console.log(fields);
        var redirectURL;
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "http://localhost:9000/submitGrade", true);
        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
        xhr.onload = function () {
            if (xhr.readyState === xhr.DONE) {
                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    var objJSON = JSON.parse(xhr.responseText);
                    redirectURL = objJSON.finalURL;
                    window.open(redirectURL,"_self");
                }
            }
        };
        xhr.send(JSON.stringify(fields));
    }
</script>
<form class="teacher">
    TeacherID&nbsp;:&nbsp;<input name="name" value="Test"><br>
    Roll&nbsp;&nbsp;&nbsp;:&nbsp;<input name="roll" value="15"><br>
    <button onclick="submitGrade()">Grade Student</button>
</form>

</body>
</html>